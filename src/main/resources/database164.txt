create DATABASE kodilla_course;

create user 'kodilla_user' identified with MYSQL_NATIVE_PASSWORD by 'kodilla_Pass123';

grant ALL PRIVILEGES ON kodilla_course.* to kodilla_user;
CREATE TABLE ISSUESLISTS
(
    ID   SERIAL PRIMARY KEY,
    NAME VARCHAR(255)
);

CREATE TABLE ISSUES (
                        ID SERIAL PRIMARY KEY,
                        ISSUESLIST_ID BIGINT UNSIGNED NOT NULL,
                        SUMMARY VARCHAR(1024),
                        DESCRIPTION VARCHAR(1024),
                        USER_ID_ASSIGNEDTO BIGINT UNSIGNED NOT NULL,
                        FOREIGN KEY (ISSUESLIST_ID) REFERENCES ISSUESLISTS(ID),
                        FOREIGN KEY (USER_ID_ASSIGNEDTO) REFERENCES USERS(USER_ID)
);
CREATE TABLE USERS(
    USER_ID SERIAL PRIMARY KEY,

);
INSERT INTO ISSUESLISTS(NAME)
VALUE ('ToDo');
COMMIT ;
SELECT * FROM ISSUESLISTS;

INSERT INTO ISSUESLISTS(NAME)
    VALUE ('In progress');
COMMIT ;
SELECT * FROM ISSUESLISTS;

INSERT INTO ISSUESLISTS(NAME)
    VALUE ('Done');
COMMIT ;
SELECT * FROM ISSUESLISTS;

INSERT INTO USERS(USER_ID)
    VALUE (12345);
COMMIT ;
SELECT * FROM USERS;

INSERT INTO  ISSUES(ISSUESLIST_ID,SUMMARY,DESCRIPTION,USER_ID_ASSIGNEDTO)
VALUES (5,'paint','description',12345);
COMMIT;
SELECT * FROM ISSUES;
SELECT * FROM USERS;
SELECT * FROM ISSUESLISTS;

INSERT INTO  ISSUES(ISSUESLIST_ID,SUMMARY,DESCRIPTION,USER_ID_ASSIGNEDTO)
VALUES (6,'wash','description',12345);
COMMIT;
SELECT * FROM ISSUES;
SELECT * FROM USERS;
SELECT * FROM ISSUESLISTS;

INSERT INTO  ISSUES(ISSUESLIST_ID,SUMMARY,DESCRIPTION,USER_ID_ASSIGNEDTO)
VALUES (7,'drive','description',12345);
COMMIT;
SELECT * FROM ISSUES;

INSERT INTO  ISSUES(ISSUESLIST_ID,SUMMARY,DESCRIPTION,USER_ID_ASSIGNEDTO)
VALUES (6,'paint2','description',12345);
COMMIT;
SELECT * FROM ISSUESLISTS;

INSERT INTO  ISSUES(ISSUESLIST_ID,SUMMARY,DESCRIPTION,USER_ID_ASSIGNEDTO)
VALUES (7,'paint3','description',12345);
COMMIT;
SELECT  * FROM ISSUESLISTS;

INSERT INTO  ISSUES(ISSUESLIST_ID,SUMMARY,DESCRIPTION,USER_ID_ASSIGNEDTO)
VALUES (5,'paint4','description',12345);
COMMIT;
SELECT * FROM ISSUES;

INSERT INTO  ISSUES(ISSUESLIST_ID,SUMMARY,DESCRIPTION,USER_ID_ASSIGNEDTO)
VALUES (5,'paint5','description',12345);
COMMIT;
SELECT * FROM ISSUES;

INSERT INTO  ISSUES(ISSUESLIST_ID,SUMMARY,DESCRIPTION,USER_ID_ASSIGNEDTO)
VALUES (5,'paint6','description',12345);
COMMIT;
SELECT * FROM ISSUES;

INSERT INTO  ISSUES(ISSUESLIST_ID,SUMMARY,DESCRIPTION,USER_ID_ASSIGNEDTO)
VALUES (5,'paint6','description',12345);
COMMIT;
SELECT * FROM ISSUES;

INSERT INTO  ISSUES(ISSUESLIST_ID,SUMMARY,DESCRIPTION,USER_ID_ASSIGNEDTO)
VALUES (6,'wash1','description',12345);
COMMIT;
SELECT * FROM ISSUES;

INSERT INTO  ISSUES(ISSUESLIST_ID,SUMMARY,DESCRIPTION,USER_ID_ASSIGNEDTO)
VALUES (6,'wash2','description',12345);
COMMIT;
SELECT * FROM ISSUES;

INSERT INTO  ISSUES(ISSUESLIST_ID,SUMMARY,DESCRIPTION,USER_ID_ASSIGNEDTO)
VALUES (6,'wash3','description',12345);
COMMIT;
SELECT * FROM ISSUES;

INSERT INTO  ISSUES(ISSUESLIST_ID,SUMMARY,DESCRIPTION,USER_ID_ASSIGNEDTO)
VALUES (7,'drive1','description',12345);
COMMIT;
SELECT * FROM ISSUES;

INSERT INTO  ISSUES(ISSUESLIST_ID,SUMMARY,DESCRIPTION,USER_ID_ASSIGNEDTO)
VALUES (7,'drive2','description',12345);
COMMIT;
SELECT * FROM ISSUES;

INSERT INTO  ISSUES(ISSUESLIST_ID,SUMMARY,DESCRIPTION,USER_ID_ASSIGNEDTO)
VALUES (7,'drive3','description',12345);
COMMIT;
SELECT * FROM ISSUES;

INSERT INTO USERS(FIRSTNAME)
VALUE ('KASIA');
COMMIT;


INSERT INTO USERS(LASTNAME)
    VALUE ('DZIK');
COMMIT;
SELECT *FROM USERS

INSERT INTO USERS(LASTNAME)
    VALUE ('BROIS');
COMMIT;
SELECT *FROM USERS

SELECT * FROM ISSUES;
SELECT L.NAME, I.SUMMARY
FROM ISSUESLISTS L
JOIN  ISSUES I ON L.ID=I.ISSUESLIST_ID;

SELECT I.SUMMARY, U.FIRSTNAME
FROM ISSUES I
JOIN USERS U ON I.USER_ID_ASSIGNEDTO=U.USER_ID;

select * from ISSUES;

UPDATE USERS
SET FIRSTNAME = 'KLARA'
WHERE USER_ID = 12345;
COMMIT;


select * from USERS;
UPDATE USERS
SET LASTNAME = 'BOLKO'
WHERE USER_ID = 12345;
COMMIT;
select * from USERS;

UPDATE USERS
SET LASTNAME = 'BOLKE'
WHERE USER_ID = 12346;
COMMIT;
select * from USERS;

UPDATE USERS
SET FIRSTNAME = 'KRIS'
WHERE USER_ID = 12347;
COMMIT;

UPDATE USERS
SET FIRSTNAME = 'KATIA'
WHERE USER_ID = 12348;
COMMIT;
select * from USERS;

SELECT U.FIRSTNAME, U.LASTNAME, COUNT(*) AS TASKS_NUMBER
FROM USERS U JOIN ISSUES I ON I.USER_ID_ASSIGNEDTO=U.USER_ID
GROUP BY U.USER_ID
HAVING COUNT(*)>0;
